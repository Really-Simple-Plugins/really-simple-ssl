"use strict";(self.webpackChunkreally_simple_ssl=self.webpackChunkreally_simple_ssl||[]).push([[634],{2387:function(e,t,l){var a=l(270),s=l(8473);const n=(0,a.Ue)(((e,t)=>({filter:"all",progressText:"",notices:[],error:!1,percentageCompleted:0,progressLoaded:!1,setFilter:t=>{sessionStorage.rsssl_task_filter=t,e((e=>({filter:t})))},fetchFilter:()=>{if("undefined"!=typeof Storage&&sessionStorage.rsssl_task_filter){let t=sessionStorage.rsssl_task_filter;e((e=>({filter:t})))}},getProgressData:async()=>{const{percentage:t,text:l,notices:a,error:n}=await s.SA("progressData","refresh").then((e=>e));e((e=>({notices:a,percentageCompleted:t,progressText:l,progressLoaded:!0,error:n})))},dismissNotice:async l=>{let a=t().notices;a=a.filter((function(e){return e.id!==l})),e((e=>({notices:a})));const{percentage:n}=await s.SA("dismiss_task",l);e({percentageCompleted:n})}})));t.Z=n},3909:function(e,t,l){var a=l(9307),s=l(5736),n=l(3882),i=l(9818),r=l(8473),o=l(4064),c=l(4559),d=l(2387),m=l(2485);t.Z=e=>{const{dismissNotice:t}=(0,d.Z)(),{getField:l,setHighLightField:u,fetchFieldsData:p}=(0,c.Z)(),{setSelectedSubMenuItem:_}=(0,m.Z)();let f=e.notice,h="premium"===f.output.icon,y=f.output.url&&-1!==f.output.url.indexOf("really-simple-ssl.com");return(0,a.createElement)("div",{className:"rsssl-task-element"},(0,a.createElement)("span",{className:"rsssl-task-status rsssl-"+f.output.icon},f.output.label),(0,a.createElement)("p",{className:"rsssl-task-message",dangerouslySetInnerHTML:{__html:f.output.msg}}),y&&f.output.url&&(0,a.createElement)("a",{target:"_blank",href:f.output.url},(0,s.__)("More info","really-simple-ssl")),f.output.clear_cache_id&&(0,a.createElement)("span",{className:"rsssl-task-enable button button-secondary",onClick:()=>(e=>{let t={};t.cache_id=e,r.Kw("clear_cache",t).then((e=>{(0,i.dispatch)("core/notices").createNotice("success",(0,s.__)("Re-started test","really-simple-ssl"),{__unstableHTML:!0,id:"rsssl_clear_cache",type:"snackbar",isDismissible:!0}).then((0,o.Z)(3e3)).then((e=>{(0,i.dispatch)("core/notices").removeNotice("rsssl_clear_cache")})),p()}))})(f.output.clear_cache_id)},(0,s.__)("Re-check","really-simple-ssl")),!h&&!y&&f.output.url&&(0,a.createElement)("a",{className:"rsssl-task-enable button button-secondary",href:f.output.url},(0,s.__)("View","really-simple-ssl")),!h&&f.output.highlight_field_id&&(0,a.createElement)("span",{className:"rsssl-task-enable button button-secondary",onClick:()=>(async()=>{u(e.notice.output.highlight_field_id);let t=l(e.notice.output.highlight_field_id);await _(t.menu_id)})()},(0,s.__)("View","really-simple-ssl")),f.output.plusone&&(0,a.createElement)("span",{className:"rsssl-plusone"},"1"),f.output.dismissible&&"completed"!==f.output.status&&(0,a.createElement)("div",{className:"rsssl-task-dismiss"},(0,a.createElement)("button",{type:"button",onClick:e=>t(f.id)},(0,a.createElement)(n.Z,{name:"times"}))))}},7372:function(e,t,l){var a=l(9307),s=l(5609),n=l(8473),i=l(5736),r=l(3882),o=l(4531),c=l(2485),d=l(4559),m=l(2387),u=l(9810),p=l(870);t.Z=e=>{const{fetchFieldsData:t,updateField:l,updateFieldsData:_,getFieldValue:f}=(0,d.Z)(),{getProgressData:h}=(0,m.Z)(),{fetchVulnerabilities:y}=(0,p.Z)(),{dismissModal:g,actionHandler:b,getSteps:v,error:E,certificateValid:w,networkwide:k,sslEnabled:N,dataLoaded:S,processing:C,setProcessing:D,steps:F,currentStep:x,currentStepIndex:L,setCurrentStepIndex:T,overrideSSL:A,setOverrideSSL:Z,networkActivationStatus:R,setNetworkActivationStatus:I,networkProgress:M,refreshSSLStatus:P,activateSSLNetworkWide:O,email:H,setEmail:j,saveEmail:U,includeTips:V,setIncludeTips:K,sendTestEmail:B,setSendTestEmail:z}=(0,u.Z)(),{setSelectedMainMenuItem:q,selectedMainMenuItem:W}=(0,c.Z)(),Y={inactive:{icon:"info",color:"orange"},warning:{icon:"circle-times",color:"orange"},error:{icon:"circle-times",color:"red"},success:{icon:"circle-check",color:"green"},processing:{icon:"file-download",color:"red"}};if((0,a.useEffect)((()=>{k&&"main_site_activated"===R&&O()}),[R,M]),(0,a.useEffect)((()=>{(async()=>{await v(!1),S&&N&&0===L&&T(1),""!==f("notifications_email_address")&&""===H&&j(f("notifications_email_address"))})()}),[]),(0,a.useEffect)((()=>{(async()=>{if(x&&x.items){let e=x.items.find((e=>"hardening"===e.id));e&&"success"===e.status&&(await t("hardening"),await h(),await y())}})()}),[x]),E)return(0,a.createElement)(o.Z,{lines:"3",error:E});let $=x,G=C?"rsssl-processing":"";return(0,a.createElement)(a.Fragment,null,!S&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"rsssl-onboarding-placeholder"},(0,a.createElement)("ul",null,(0,a.createElement)("li",null,(0,a.createElement)(r.Z,{name:"file-download",color:"grey"}),(0,i.__)("Fetching next step...","really-simple-ssl"))),(0,a.createElement)(o.Z,{lines:"3"}))),S&&(0,a.createElement)("div",{className:"rsssl-modal-content-step "+G},(0,a.createElement)("ul",null,(Q=$.items)&&Q.map(((e,t)=>{let{title:l,description:n,current_action:o,action:c,status:d,button:m,id:u,read_more:p}=e;"ssl_enabled"===u&&k&&(M>=100?(d="success",l=(0,i.__)("SSL has been activated network wide","really-simple-ssl")):(d="processing",l=(0,i.__)("Processing activation of subsites networkwide","really-simple-ssl")));const _="success"!==e.status&&e.is_plugin&&"none"===e.current_action?"empty":Y[d].icon,f=Y[d].color,h={activate_setting:(0,i.__)("Activating...","really-simple-ssl"),activate:(0,i.__)("Activating...","really-simple-ssl"),install_plugin:(0,i.__)("Installing...","really-simple-ssl"),error:(0,i.__)("Failed","really-simple-ssl"),completed:(0,i.__)("Finished","really-simple-ssl")};let y="";m&&(y=m,"none"!==o&&(y=h[o],"failed"===o&&(y=h.error)));let g=m&&m===y,v="success"!==e.status&&e.is_plugin&&"none"===e.current_action,E=v?"rsssl-is-plugin":"";return l=v?(0,a.createElement)("b",null,l):l,(0,a.createElement)("li",{key:"pluginItem-"+t,className:E},(0,a.createElement)(r.Z,{name:_,color:f}),l,n&&(0,a.createElement)(a.Fragment,null," - ",n),"ssl_enabled"===u&&k&&"main_site_activated"===R&&(0,a.createElement)(a.Fragment,null," - ",M<100&&(0,a.createElement)(a.Fragment,null,(0,i.__)("working","really-simple-ssl")," ",M,"%"),M>=100&&(0,i.__)("completed","really-simple-ssl")),m&&(0,a.createElement)(a.Fragment,null," - ",g&&(0,a.createElement)(s.Button,{isLink:!0,onClick:e=>b(u,c,e)},y),!g&&(0,a.createElement)(a.Fragment,null,y)),v&&p&&(0,a.createElement)("a",{target:"_blank",href:p,className:"button button-default rsssl-read-more"},(0,i.__)("Read More","really-simple-ssl")))}))),"email"===x.id&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",null,(0,a.createElement)("input",{type:"email",value:H,placeholder:(0,i.__)("Your email address","really-simple-ssl"),onChange:e=>j(e.target.value)})),(0,a.createElement)("div",null,(0,a.createElement)("label",null,(0,a.createElement)("input",{onChange:e=>K(e.target.checked),type:"checkbox",checked:V}),(0,i.__)("Include 6 Tips & Tricks to get started with Really Simple SSL.","really-simple-ssl")," ",(0,a.createElement)("a",{href:"https://really-simple-ssl.com/legal/privacy-statement/",target:"_blank"},(0,i.__)("Privacy Statement","really-simple-ssl")))),(0,a.createElement)("div",null)),w&&$.info_text&&(0,a.createElement)("div",{className:"rsssl-modal-description",dangerouslySetInnerHTML:{__html:$.info_text}}),0===L&&!w&&(0,a.createElement)("div",{className:"rsssl-modal-description"},(0,a.createElement)("a",{href:"#",onClick:e=>P(e)},(0,i.__)("Refresh SSL status","really-simple-ssl"))," ",(0,i.__)("The SSL detection method is not 100% accurate.","really-simple-ssl")," ",(0,i.__)("If you’re certain an SSL certificate is present, and refresh SSL status does not work, please check “Override SSL detection” to continue activating SSL.","really-simple-ssl")),(0,a.createElement)("div",{className:"rsssl-modal-content-step-footer"},(()=>{let r=k?(0,i.__)("Activate SSL networkwide","really-simple-ssl"):(0,i.__)("Activate SSL","really-simple-ssl");return 0===L?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("button",{disabled:C||!w&&!A,className:"button button-primary",onClick:()=>{D(!0),n.SA("activate_ssl").then((async e=>{D(!1),T(L+1),e.success&&(e.site_url_changed?window.location.reload():k&&I("main_site_activated"))})).then((async()=>{await h(),await t(W)}))}},r),w&&!rsssl_settings.pro_plugin_active&&(0,a.createElement)("a",{target:"_blank",href:rsssl_settings.upgrade_link,className:"button button-default"},(0,i.__)("Improve Security with PRO","really-simple-ssl")),!w&&(0,a.createElement)("button",{className:"button button-default",onClick:()=>{e.isModal&&g(),window.location.href=rsssl_settings.letsencrypt_url}},(0,i.__)("Install SSL","really-simple-ssl")),!w&&(0,a.createElement)(s.ToggleControl,{label:(0,i.__)("Override SSL detection","really-simple-ssl"),checked:A,onChange:e=>{Z(e);let t={};t.overrideSSL=e,n.Kw("override_ssl_detection",t)}})):L>0&&L<F.length-1?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("button",{disabled:C,className:"button button-primary",onClick:()=>(async()=>{await U(),l("send_notifications_email",!0),l("notifications_email_address",H),_()})()},(0,i.__)("Save and continue","really-simple-ssl")),(0,a.createElement)("button",{disabled:C,className:"button button-default",onClick:()=>{T(L+1)}},(0,i.__)("Skip","really-simple-ssl"))):F.length-1===L?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("button",{className:"button button-primary",onClick:()=>{e.isModal&&g(),q("dashboard")}},(0,i.__)("Go to Dashboard","really-simple-ssl")),(0,a.createElement)("button",{className:"button button-default",onClick:()=>g()},(0,i.__)("Dismiss","really-simple-ssl"))):void 0})())));var Q}},4634:function(e,t,l){l.r(t),l.d(t,{default:function(){return de}});var a=l(9307),s=l(5609),n=l(5736),i=l(3909),r=l(8473),o=l(4559),c=l(1789),d=e=>{const{fields:t,setChangedField:l,updateField:s}=(0,o.Z)(),{licenseStatus:d,setLicenseStatus:m}=(0,c.Z)(),[u,p]=(0,a.useState)(!1),[_,f]=(0,a.useState)(!1),[h,y]=(0,a.useState)(!1);(0,a.useEffect)((()=>{r.SA("licenseNotices","refresh").then((e=>e)).then((e=>{m(e.licenseStatus),y(e.notices),p(!0)}))}),[t]);let g=e.field;return(0,a.createElement)("div",{className:"components-base-control"},(0,a.createElement)("div",{className:"components-base-control__field"},(0,a.createElement)("label",{className:"components-base-control__label",htmlFor:g.id},g.label),(0,a.createElement)("div",{className:"rsssl-license-field"},(0,a.createElement)("input",{className:"components-text-control__input",type:"password",id:g.id,value:g.value,onChange:e=>{return t=e.target.value,l(g.id,t),void s(g.id,t);var t}}),(0,a.createElement)("button",{className:"button button-default",onClick:()=>(()=>{if(p(!1),"valid"===d)r.SA("deactivate_license").then((e=>{m(e.licenseStatus),y(e.notices),p(!0)}));else{let t={};t.license=e.field.value,r.Kw("activate_license",t).then((e=>{m(e.licenseStatus),y(e.notices),p(!0)}))}})()},"valid"===d&&(0,a.createElement)(a.Fragment,null,(0,n.__)("Deactivate","really-simple-ssl")),"valid"!==d&&(0,a.createElement)(a.Fragment,null,(0,n.__)("Activate","really-simple-ssl"))))),u&&h.map(((e,t)=>(0,a.createElement)(i.Z,{key:t,index:t,notice:e,highLightField:""}))))},m=e=>{const{updateField:t,setChangedField:l}=(0,o.Z)();return(0,a.createElement)("div",{className:"components-base-control"},(0,a.createElement)("div",{className:"components-base-control__field"},(0,a.createElement)("label",{className:"components-base-control__label",htmlFor:e.field.id},e.field.label),(0,a.createElement)("input",{className:"components-text-control__input",type:"password",id:e.field.id,value:e.field.value,onChange:a=>{return s=a.target.value,t(e.field.id,s),void l(e.field.id,s);var s}})))},u=e=>{let t=e.field,l=!Array.isArray(e.disabled)&&e.disabled,s=!!Array.isArray(e.disabled)&&e.disabled;return(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"components-base-control"},(0,a.createElement)("div",{className:"components-base-control__field"},(0,a.createElement)("div",{"data-wp-component":"HStack",className:"components-flex components-select-control"},(0,a.createElement)("label",{htmlFor:t.id,className:"components-toggle-control__label"},e.label),(0,a.createElement)("select",{disabled:l,value:e.value,onChange:t=>e.onChangeHandler(t.target.value)},e.options.map(((e,t)=>(0,a.createElement)("option",{key:t,value:e.value,disabled:s&&s.includes(e.value)},e.label))))))),t.comment&&(0,a.createElement)("div",{className:"rsssl-comment",dangerouslySetInnerHTML:{__html:t.comment}}))},p=e=>{const{updateField:t,setChangedField:l,saveFields:n,handleNextButtonDisabled:i}=(0,o.Z)(),r=(0,a.useRef)(!1);let c=e.field.value,d=e.field,m=[];if(d.options)for(var u in d.options)if(d.options.hasOwnProperty(u)){let e={};e.label=d.options[u],e.value=u,m.push(e)}return(0,a.createElement)(s.SelectControl,{label:d.label,onChange:a=>(async a=>{let s=e.field;i(!0),r.current=!0,t(s.id,a),l(s.id,a),await n(!0,!1),i(!1),r.current=!1})(a),value:c,options:m,disabled:r.current})},_=l(9950),f=l(4064),h=l(9818),y=l(7839),g=l(2485),b=e=>{const{addHelpNotice:t,updateField:l,setChangedField:i,saveFields:c,fetchFieldsData:d}=(0,o.Z)(),{setSelectedSubMenuItem:m}=(0,g.Z)();let u=e.action;if((0,y.Z)((()=>{u&&"challenge_directory_reachable"===u.action&&"error"===u.status&&t(e.field.id,"default",(0,n.__)("The challenge directory is used to verify the domain ownership.","really-simple-ssl")),u&&"check_key_directory"===u.action&&"error"===u.status&&t(e.field.id,"default",(0,n.__)("The key directory is needed to store the generated keys.","really-simple-ssl")+" "+(0,n.__)("By placing it outside the root folder, it is not publicly accessible.","really-simple-ssl")),u&&"check_certs_directory"===u.action&&"error"===u.status&&t(e.field.id,"default",(0,n.__)("The certificate will get stored in this directory.","really-simple-ssl")+" "+(0,n.__)("By placing it outside the root folder, it is not publicly accessible.","really-simple-ssl"))})),!u)return(0,a.createElement)(a.Fragment,null);const p=async()=>{l("verification_type","dns"),i("verification_type","dns"),await c(!0,!0),await r.Kr("update_verification_type","dns").then((e=>{(0,h.dispatch)("core/notices").createNotice("success",(0,n.__)("Switched to DNS","really-simple-ssl"),{__unstableHTML:!0,id:"rsssl_switched_to_dns",type:"snackbar",isDismissible:!0}).then((0,f.Z)(3e3)).then((e=>{(0,h.dispatch)("core/notices").removeNotice("rsssl_switched_to_dns")}))})),await m("le-dns-verification"),await d("le-directories")};return(0,a.createElement)("div",{className:"rsssl-test-results"},"error"===u.status&&(0,a.createElement)("h4",null,(0,n.__)("Next step","really-simple-ssl")),"error"===u.status&&"challenge_directory_reachable"===u.action&&(0,a.createElement)("div",null,(0,a.createElement)("p",null,(0,n.__)("If the challenge directory cannot be created, or is not reachable, you can either remove the server limitation, or change to DNS verification.","really-simple-ssl")),(0,a.createElement)(s.Button,{variant:"secondary",onClick:()=>p()},(0,n.__)("Switch to DNS verification","really-simple-ssl"))),"cpanel"===rsssl_settings.hosting_dashboard&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("p",null,(0,a.createElement)(_.Z,{target:"_blank",text:(0,n.__)("If you also want to secure subdomains like mail.domain.com, cpanel.domain.com, you have to use the %sDNS%s challenge.","really-simple-ssl"),url:"https://really-simple-ssl.com/lets-encrypt-authorization-with-dns"})," ",(0,n.__)("Please note that auto-renewal with a DNS challenge might not be possible.","really-simple-ssl")),(0,a.createElement)(s.Button,{variant:"secondary",onClick:()=>p()},(0,n.__)("Switch to DNS verification","really-simple-ssl"))),"error"===u.status&&"check_challenge_directory"===u.action&&(0,a.createElement)("div",null,(0,a.createElement)("h4",null,(0,n.__)("Create a challenge directory","really-simple-ssl")),(0,a.createElement)("p",null,(0,n.__)("Navigate in FTP or File Manager to the root of your WordPress installation:","really-simple-ssl")),(0,a.createElement)("ul",null,(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Create a folder called “.well-known”","really-simple-ssl")),(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Inside the folder called “.well-known” create a new folder called “acme-challenge”, with 644 writing permissions.","really-simple-ssl")),(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Click the refresh button.","really-simple-ssl"))),(0,a.createElement)("h4",null,(0,n.__)("Or you can switch to DNS verification","really-simple-ssl")),(0,a.createElement)("p",null,(0,n.__)("If the challenge directory cannot be created, you can either remove the server limitation, or change to DNS verification.","really-simple-ssl")),(0,a.createElement)(s.Button,{variant:"secondary",onClick:()=>p()},(0,n.__)("Switch to DNS verification","really-simple-ssl"))),"error"===u.status&&"check_key_directory"===u.action&&(0,a.createElement)("div",null,(0,a.createElement)("h4",null,(0,n.__)("Create a key directory","really-simple-ssl")),(0,a.createElement)("p",null,(0,n.__)("Navigate in FTP or File Manager to one level above the root of your WordPress installation:","really-simple-ssl")),(0,a.createElement)("ul",null,(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Create a folder called “ssl”","really-simple-ssl")),(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Inside the folder called “ssl” create a new folder called “keys”, with 644 writing permissions.","really-simple-ssl")),(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Click the refresh button.","really-simple-ssl")))),"error"===u.status&&"check_certs_directory"===u.action&&(0,a.createElement)("div",null,(0,a.createElement)("h4",null,(0,n.__)("Create a certs directory","really-simple-ssl")),(0,a.createElement)("p",null,(0,n.__)("Navigate in FTP or File Manager to one level above the root of your WordPress installation:","really-simple-ssl")),(0,a.createElement)("ul",null,(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Create a folder called “ssl”","really-simple-ssl")),(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Inside the folder called “ssl” create a new folder called “certs”, with 644 writing permissions.","really-simple-ssl")),(0,a.createElement)("li",{className:"rsssl-tooltip-icon dashicons-before rsssl-icon arrow-right-alt2 dashicons-arrow-right-alt2"},(0,n.__)("Click the refresh button.","really-simple-ssl")))))},v=e=>{const{fields:t,addHelpNotice:l,updateField:i,setChangedField:c,saveFields:d,fetchFieldsData:m,getFieldValue:u}=(0,o.Z)(),{selectedSubMenuItem:p,setSelectedSubMenuItem:b}=(0,g.Z)(),[v,E]=(0,a.useState)(!1);let w=e.action;return(0,y.Z)((()=>{w&&"challenge_directory_reachable"===w.action&&"error"===w.status&&l(e.field.id,"default",(0,n.__)("The challenge directory is used to verify the domain ownership.","really-simple-ssl"));let t=!!w&&w.output;void 0!==t&&0!==t.length||(t=!1),t&&E(t)})),"dir"===u("verification_type")?(0,a.createElement)(a.Fragment,null):(0,a.createElement)(a.Fragment,null,v&&v.length>0&&(0,a.createElement)("div",{className:"rsssl-test-results"},(0,a.createElement)("h4",null,(0,n.__)("Next step","really-simple-ssl")),(0,a.createElement)("p",null,(0,n.__)("Add the following token as text record to your DNS records. We recommend to use a short TTL during installation, in case you need to change it.","really-simple-ssl"),(0,a.createElement)(_.Z,{target:"_blank",text:(0,n.__)("Read more","really-simple-ssl"),url:"https://really-simple-ssl.com/how-to-add-a-txt-record-to-dns"})),(0,a.createElement)("div",{className:"rsssl-dns-text-records"},(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"rsssl-dns-domain"},"@/",(0,n.__)("domain","really-simple-ssl")),(0,a.createElement)("div",{className:"rsssl-dns-field"},(0,n.__)("Value","really-simple-ssl"))),v.map(((e,t)=>(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"rsssl-dns-"},"_acme-challenge.",e.domain),(0,a.createElement)("div",{className:"rsssl-dns-field rsssl-selectable"},e.token)))))),(0,a.createElement)("div",{className:"rsssl-test-results"},(0,a.createElement)("p",null,(0,n.__)("DNS verification active. You can switch back to directory verification here.","really-simple-ssl")),(0,a.createElement)(s.Button,{variant:"secondary",onClick:()=>(async()=>{await b("le-directories"),await i("verification_type","dir"),await c("verification_type","dir"),await d(!0,!0),await r.Kr("update_verification_type","dir").then((e=>{(0,h.dispatch)("core/notices").createNotice("success",(0,n.__)("Switched to Directory","really-simple-ssl"),{__unstableHTML:!0,id:"rsssl_switched_to_dns",type:"snackbar",isDismissible:!0}).then((0,f.Z)(3e3)).then((e=>{(0,h.dispatch)("core/notices").removeNotice("rsssl_switched_to_dns")}))})),await m("le-directories")})()},(0,n.__)("Switch to directory verification","really-simple-ssl"))))},E=e=>{let t=e.action;return t?(0,a.createElement)("div",{className:"rsssl-test-results"},"error"===t.status&&"verify_dns"===t.action&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("p",null,(0,n.__)("We could not check the DNS records. If you just added the record, please check in a few minutes.","really-simple-ssl")," ",(0,a.createElement)(_.Z,{target:"_blank",text:(0,n.__)("You can manually check the DNS records in an %sonline tool%s.","really-simple-ssl"),url:"https://mxtoolbox.com/SuperTool.aspx"}),(0,n.__)("If you're sure it's set correctly, you can click the button to skip the DNS check.","really-simple-ssl")," "),(0,a.createElement)(s.Button,{variant:"secondary",onClick:()=>r.Kr("skip_dns_check").then((t=>{e.restartTests(),(0,h.dispatch)("core/notices").createNotice("success",(0,n.__)("Skip DNS verification","really-simple-ssl"),{__unstableHTML:!0,id:"rsssl_skip_dns",type:"snackbar",isDismissible:!0}).then((0,f.Z)(3e3)).then((e=>{(0,h.dispatch)("core/notices").removeNotice("rsssl_skip_dns")}))}))},(0,n.__)("Skip DNS check","really-simple-ssl")))):(0,a.createElement)(a.Fragment,null)},w=l(7372),k=()=>(0,a.createElement)("div",{className:"rsssl-lets-encrypt-tests"},(0,a.createElement)(w.Z,null)),N=e=>{const{addHelpNotice:t}=(0,o.Z)(),[l,s]=(0,a.useState)(!1);let i=e.action;(0,y.Z)((()=>{i&&"warning"===i.status&&l&&l.generated_by_rsssl&&(t(e.field.id,"default",(0,n.__)("This is the certificate, which you need to install in your hosting dashboard.","really-simple-ssl"),(0,n.__)("Certificate (CRT)","really-simple-ssl")),t(e.field.id,"default",(0,n.__)("The private key can be uploaded or pasted in the appropriate field on your hosting dashboard.","really-simple-ssl"),(0,n.__)("Private Key (KEY)","really-simple-ssl")),t(e.field.id,"default",(0,n.__)("The CA Bundle will sometimes be automatically detected. If not, you can use this file.","really-simple-ssl"),(0,n.__)("Certificate Authority Bundle (CABUNDLE)","really-simple-ssl"))),!i||"error"!==i.status&&"warning"!==i.status||r.Kr("installation_data").then((e=>{e&&s(e.output)}))}));const c=e=>{let t,l=document.querySelector(".rsssl-"+e).innerText;const a=document.createElement("textarea");a.value=l,document.body.appendChild(a),a.select();try{t=document.execCommand("copy")}catch(e){t=!1}document.body.removeChild(a),(0,h.dispatch)("core/notices").createNotice("success",(0,n.__)("Copied!","really-simple-ssl"),{__unstableHTML:!0,id:"rsssl_copied_data",type:"snackbar",isDismissible:!0}).then((0,f.Z)(3e3)).then((e=>{(0,h.dispatch)("core/notices").removeNotice("rsssl_copied_data")}))};return i&&l?(0,a.createElement)("div",{className:"rsssl-test-results"},!l.generated_by_rsssl&&(0,a.createElement)(a.Fragment,null,(0,n.__)("The certificate is not generated by Really Simple SSL, so there are no installation files here","really-simple-ssl")),l.generated_by_rsssl&&"warning"===i.status&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("h4",null,(0,n.__)("Next step","really-simple-ssl")),(0,a.createElement)("div",{className:"rsssl-template-intro"},(0,n.__)("Install your certificate.","really-simple-ssl")),(0,a.createElement)("h4",null,(0,n.__)("Certificate (CRT)","really-simple-ssl")),(0,a.createElement)("div",{className:"rsssl-certificate-data rsssl-certificate",id:"rsssl-certificate"},l.certificate_content),(0,a.createElement)("a",{href:l.download_url+"&type=certificate",className:"button button-secondary"},(0,n.__)("Download","really-simple-ssl")),(0,a.createElement)("button",{type:"button",onClick:e=>c("certificate"),className:"button button-primary"},(0,n.__)("Copy content","really-simple-ssl")),(0,a.createElement)("h4",null,(0,n.__)("Private Key (KEY)","really-simple-ssl")),(0,a.createElement)("div",{className:"rsssl-certificate-data rsssl-key",id:"rsssl-key"},l.key_content),(0,a.createElement)("a",{href:l.download_url+"&type=private_key",className:"button button-secondary"},(0,n.__)("Download","really-simple-ssl")),(0,a.createElement)("button",{type:"button",className:"button button-primary",onClick:e=>c("key")},(0,n.__)("Copy content","really-simple-ssl")),(0,a.createElement)("h4",null,(0,n.__)("Certificate Authority Bundle (CABUNDLE)","really-simple-ssl")),(0,a.createElement)("div",{className:"rsssl-certificate-data rsssl-cabundle",id:"rsssl-cabundle"},l.ca_bundle_content),(0,a.createElement)("a",{href:l.download_url+"&type=intermediate",className:"button button-secondary"},(0,n.__)("Download","really-simple-ssl")),(0,a.createElement)("button",{type:"button",className:"button button-primary",onClick:e=>c("cabundle")},(0,n.__)("Copy content","really-simple-ssl")))):(0,a.createElement)(a.Fragment,null)},S=l(3882),C=l(8914),D=e=>{const{handleNextButtonDisabled:t,getFieldValue:l}=(0,o.Z)(),{actionsList:s,setActionsList:i,setActionsListItem:c,setActionsListProperty:d,actionIndex:m,setActionIndex:u,attemptCount:p,setAttemptCount:_,progress:h,setProgress:y,refreshTests:g,setRefreshTests:w}=(0,C.Z)(),D=(0,a.useRef)(1e3),F=((0,a.useRef)(!1),(0,a.useRef)(-1)),x=(0,a.useRef)(1),L=(0,a.useRef)(0),T=(0,a.useRef)({});(0,a.useEffect)((()=>{Z()}),[e.field.id]),(0,a.useEffect)((()=>{s.length>0&&-1===m&&(u(0),I(0,0))}),[s]),(0,a.useEffect)((()=>{}),[]),(0,a.useEffect)((()=>{F.current=m,y(100/x.current*m);let e=s[m];e&&"retry"===e.do&&p>1&&y(90)}),[m]),(0,a.useEffect)((()=>{L.current=h}),[h]),(0,a.useEffect)((()=>{g&&(w(!1),Z(),s.forEach((function(e,t){d(t,"status","inactive")})))}),[g]);const A={inactive:{icon:"circle-times",color:"grey"},warning:{icon:"circle-times",color:"orange"},error:{icon:"circle-times",color:"red"},success:{icon:"circle-check",color:"green"}},Z=()=>{t(!0),i((()=>{let t=e.field.actions;return"generation"===e.field.id&&(t=R(t)),x.current=t.length,t})()),y(0),L.current=0,u(-1),F.current=-1},R=e=>{let t=l("verification_type");if(t||(t="dir"),"dns"===t){let t=!1;e.forEach((function(e,l){"verify_dns"===e.action&&(t=!0)}));let l=-1;if(e.forEach((function(e,t){"create_bundle_or_renew"===e.action&&(l=t)})),!t&&l>0){let t=[...e],a=t[l],s={action:"verify_dns"};s.description=(0,n.__)("Verifying DNS records...","really-simple-ssl"),s.attempts=2,t[l]=s,t.push(a),e=t}}return e},I=async l=>{let a={...s[l]};if(!a)return;let n=a.action;const i=new Date;await r.Kr(n,e.field.id).then((e=>{let t=new Date-i;const s=Math.round(t);a.status=e.status?e.status:"inactive",a.hide=!1,a.description=e.message,a.do=e.action,a.output=!!e.output&&e.output,D.current=500,s<1500&&(D.current=1500-s),c(l,a)})).then((0,f.Z)(D.current)).then((()=>{(async(e,l)=>{"success"===e.status?_(0):(Number.isInteger(e.attemptCount)||_(0),_(p+1));let a=new CustomEvent("rsssl_le_response",{detail:e});document.dispatchEvent(a),"finalize"===e.do?(s.forEach((function(e,t){t>l&&d(t,"hide",!0)})),u(x.current+1),t(!1)):"continue"===e.do||"skip"===e.do?(_(1),"skip"===e.do&&d(l,"hide",!0),x.current-1>l?(u(l+1),await I(l+1)):(u(l+1),t(!1))):"retry"===e.do?p>=e.attempts?u(x.current):(u(l),await I(l)):"stop"===e.do&&u(x.current)})(a,l)}))},M=e=>A.hasOwnProperty(e.status)?A[e.status].icon:A.inactive.icon,P=e=>A.hasOwnProperty(e.status)?A[e.status].color:A.inactive.color;if(!e.field.actions)return(0,a.createElement)(a.Fragment,null);let O=h;x.current===m+1&&(O=100);let H=s.filter((e=>!0!==e.hide)),j=s[m];j?T.current=j:j=T.current;let U="error"===j.status?"rsssl-orange":"";return(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"rsssl-lets-encrypt-tests"},(0,a.createElement)("div",{className:"rsssl-progress-bar"},(0,a.createElement)("div",{className:"rsssl-progress"},(0,a.createElement)("div",{className:"rsssl-bar "+U,style:(V=O,Object.assign({},{width:V+"%"}))}))),(0,a.createElement)("div",{className:"rsssl_letsencrypt_container rsssl-progress-container field-group"},(0,a.createElement)("ul",null,H.map(((e,t)=>(0,a.createElement)("li",{key:"action-"+t},(0,a.createElement)(S.Z,{name:M(e),color:P(e)}),"retry"===e.do&&p>=1&&(0,a.createElement)(a.Fragment,null,(0,n.__)("Attempt %s.","really-simple-ssl").replace("%s",p)," ")," ",(0,a.createElement)("span",{dangerouslySetInnerHTML:{__html:e.description}})))))),"directories"===e.field.id&&(0,a.createElement)(b,{field:e.field,action:j}),"dns-verification"===e.field.id&&(0,a.createElement)(v,{field:e.field,action:j}),"generation"===e.field.id&&(0,a.createElement)(E,{field:e.field,action:j}),"installation"===e.field.id&&(0,a.createElement)(N,{field:e.field,action:j}),"activate"===e.field.id&&(0,a.createElement)(k,{field:e.field,action:j})));var V},F=l(5097),x=e=>{const{handleModal:t}=(0,F.Z)();return(0,a.createElement)("button",{className:"button button-"+e.btnStyle,onClick:l=>{t(!0,e.modalData,e.item)}},e.btnText)},L=l(270),T=(0,L.Ue)(((e,t)=>({mixedContentData:[],dataLoaded:!1,fixedItemId:!1,action:"",nonce:"",completedStatus:"never",progress:0,scanStatus:!1,fetchMixedContentData:async()=>{e({scanStatus:"running"});const{data:t,progress:l,state:a,action:s,nonce:n,completed_status:i}=await A(!1);e({scanStatus:a,mixedContentData:t,progress:l,action:s,nonce:n,completedStatus:i,dataLoaded:!0})},start:async()=>{const{data:t,progress:l,state:a,action:s,nonce:n,completed_status:i}=await A("start");e({scanStatus:a,mixedContentData:t,progress:l,action:s,nonce:n,completedStatus:i,dataLoaded:!0})},runScanIteration:async()=>{let l=t().scanStatus;if("stop"===l)return;const{data:a,progress:s,state:n,action:i,nonce:r,completed_status:o}=await A(l);"stop"!==t().scanStatus&&e({scanStatus:n,mixedContentData:a,progress:s,action:i,nonce:r,completedStatus:o,dataLoaded:!0})},stop:async()=>{e({scanStatus:"stop"});const{data:t,progress:l,state:a,action:s,nonce:n,completed_status:i}=await A("stop");e({scanStatus:"stop",mixedContentData:t,progress:l,action:s,nonce:n,completedStatus:i})},removeDataItem:l=>{let a=t().mixedContentData;for(const e of a)e.id===l.id&&(e.fixed=!0);e({mixedContentData:a})},ignoreDataItem:l=>{let a=t().mixedContentData;for(const e of a)e.id===l.id&&(e.ignored=!0);e({mixedContentData:a})}})));const A=async e=>await r.SA("mixed_content_scan",e).then((t=>{let l=t.data;return"object"==typeof l&&(l=Object.values(l)),Array.isArray(l)||(l=[]),t.data=l,"stop"===e&&(t.state="stop"),t}));var Z=e=>{const{fixedItems:t,ignoredItems:i}=(0,F.Z)(),{fetchMixedContentData:r,mixedContentData:o,runScanIteration:c,start:d,stop:m,dataLoaded:u,action:p,scanStatus:_,progress:f,completedStatus:h,nonce:y,removeDataItem:g,ignoreDataItem:b}=T(),[v,E]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!1),[N,C]=(0,a.useState)(null),[D,L]=(0,a.useState)(null);(0,a.useEffect)((()=>{Promise.resolve().then(l.bind(l,44)).then((e=>{let{default:t,createTheme:l}=e;C((()=>t)),L((()=>l("really-simple-plugins",{divider:{default:"transparent"}},"light")))}))}),[]),(0,a.useEffect)((()=>{r()}),[]),(0,a.useEffect)((()=>{"running"===_&&c()}),[f,_]);let A=e.field,Z=[];A.columns.forEach((function(e,t){let l={name:e.name,sortable:e.sortable,grow:e.grow,selector:t=>t[e.column],right:!!e.right};Z.push(l)}));let R=u?o:[];for(const l of R)l.warningControl=(0,a.createElement)("span",{className:"rsssl-task-status rsssl-warning"},(0,n.__)("Warning","really-simple-ssl")),t.includes(l.id)&&(l.fixed=!0),i.includes(l.id)&&(l.ignored=!0),l.fix&&(l.fix.url=l.blocked_url,l.fix.nonce=y),l.details&&(l.details.url=l.blocked_url,l.details.nonce=y,l.details.ignored=l.ignored),l.location.length>0&&(-1!==l.location.indexOf("http://")||-1!==l.location.indexOf("https://")?l.locationControl=(0,a.createElement)("a",{href:l.location,target:"_blank"},(0,n.__)("View","really-simple-ssl")):l.locationControl=l.location),l.detailsControl=l.details&&(0,a.createElement)(x,{handleModal:e.handleModal,item:l,id:l.id,btnText:(0,n.__)("Details","really-simple-ssl"),btnStyle:"secondary",modalData:l.details}),l.fixControl=l.fix&&(0,a.createElement)(x,{className:"button button-primary",handleModal:e.handleModal,item:l,id:l.id,btnText:(0,n.__)("Fix","really-simple-ssl"),btnStyle:"primary",modalData:l.fix});v||(R=R.filter((e=>!e.ignored))),R=R.filter((e=>!e.fixed));let I=f+"%",M="running"===_,P="running"!==_;return(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"rsssl-progress-container"},(0,a.createElement)("div",{className:"rsssl-progress-bar",style:{width:I}})),"running"===_&&(0,a.createElement)("div",{className:"rsssl-current-scan-action"},p),0===R.length&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"rsssl-mixed-content-description"},"running"!==_&&"never"===h&&(0,n.__)("No results. Start your first scan","really-simple-ssl"),"running"!==_&&"completed"===h&&(0,n.__)("Everything is now served over SSL","really-simple-ssl")),("running"===_||"completed"!==h)&&(0,a.createElement)("div",{className:"rsssl-mixed-content-placeholder"},(0,a.createElement)("div",null),(0,a.createElement)("div",null),(0,a.createElement)("div",null)),"running"!==_&&"completed"===h&&(0,a.createElement)("div",{className:"rsssl-shield-overlay"},(0,a.createElement)(S.Z,{name:"shield",size:"80px"}))),N&&R.length>0&&(0,a.createElement)("div",{className:"rsssl-mixed-content-datatable"},(0,a.createElement)(N,{columns:Z,data:R,dense:!0,pagination:!0,paginationResetDefaultPage:w,noDataComponent:(0,n.__)("No results","really-simple-ssl"),theme:D,customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}}})),(0,a.createElement)("div",{className:"rsssl-grid-item-content-footer"},(0,a.createElement)("button",{className:"button",disabled:M,onClick:()=>d()},(0,n.__)("Start scan","really-simple-ssl")),(0,a.createElement)("button",{className:"button",disabled:P,onClick:()=>m()},(0,n.__)("Stop","really-simple-ssl")),(0,a.createElement)(s.ToggleControl,{checked:1==v,onChange:e=>{E(!v)}}),(0,a.createElement)("label",null,(0,n.__)("Show ignored URLs","really-simple-ssl"))))},R=e=>{const{fields:t,updateField:i,updateSubField:r,setChangedField:c,saveFields:d}=(0,o.Z)(),[m,u]=(0,a.useState)(0),[p,_]=(0,a.useState)(null),[f,h]=(0,a.useState)(null);(0,a.useEffect)((()=>{Promise.resolve().then(l.bind(l,44)).then((e=>{let{default:t,createTheme:l}=e;_((()=>t)),h((()=>l("really-simple-plugins",{divider:{default:"transparent"}},"light")))}))}),[]),(0,a.useEffect)((()=>{let e=t.filter((e=>"enable_permissions_policy"===e.id))[0];u(e.value)}),[]);const y=(t,l)=>{let a=e.field;"object"==typeof a.value&&i(a.id,Object.values(a.value)),r(a.id,l.id,t),c(a.id,t),d(!0,!1)},g=(e,l)=>{e.preventDefault();let a=t.filter((e=>"enable_permissions_policy"===e.id))[0];u(l),i(a.id,l),c(a.id,a.value),d(!0,!1)};let b=e.field,v=(b.value,e.options);columns=[],b.columns.forEach((function(e,t){let l={name:e.name,sortable:e.sortable,width:e.width,selector:t=>t[e.column]};columns.push(l)}));let E=b.value;"object"==typeof E&&(E=Object.values(E)),Array.isArray(E)||(E=[]);let w=[];for(const e of E){let t={...e};t.valueControl=(0,a.createElement)(s.SelectControl,{help:"",value:e.value,disabled:!1,options:v,label:"",onChange:t=>y(t,e)}),w.push(t)}return p&&f?(0,a.createElement)("div",null,(0,a.createElement)(p,{columns:columns,data:w,dense:!0,pagination:!1,customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},theme:f}),1!=m&&(0,a.createElement)("button",{className:"button button-primary",onClick:e=>g(e,!0)},(0,n.__)("Enforce","really-simple-ssl")),1==m&&(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-shield-overlay"},(0,a.createElement)(S.Z,{name:"shield",size:"80px"})),(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-progress-status rsssl-learning-mode-enforced"},(0,n.__)("Enforced","really-simple-ssl")),e.disabled&&(0,a.createElement)(a.Fragment,null,(0,n.__)("Permissions Policy is set outside Really Simple SSL.","really-simple-ssl")," "),!e.disabled&&(0,a.createElement)(a.Fragment,null,(0,n.__)("Permissions Policy is enforced.","really-simple-ssl")," "),!e.disabled&&(0,a.createElement)("a",{className:"rsssl-learning-mode-link",href:"#",onClick:e=>g(e,!1)},(0,n.__)("Disable","really-simple-ssl")))),e.disabled&&1!=m&&(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-progress-status rsssl-disabled"},(0,n.__)("Disabled","really-simple-ssl")),(0,n.__)("The Permissions Policy has been disabled.","really-simple-ssl")))):null},I=e=>{const[t,l]=(0,a.useState)(!1),n=t=>{s.__experimentalConfirmDialog&&e.field.warning&&e.field.warning.length>0&&!e.field.value?l(!0):i()},i=t=>{let l=!e.field.value;e.onChangeHandler(l)};let r=e.field,o=r.value?"is-checked":"",c=e.disabled?"is-disabled":"";return(0,a.createElement)(a.Fragment,null,s.__experimentalConfirmDialog&&(0,a.createElement)(s.__experimentalConfirmDialog,{isOpen:t,onConfirm:async()=>{l(!1),i()},onCancel:()=>{l(!1)}},r.warning),(0,a.createElement)("div",{className:"components-base-control components-toggle-control"},(0,a.createElement)("div",{className:"components-base-control__field"},(0,a.createElement)("div",{"data-wp-component":"HStack",className:"components-flex components-h-stack"},(0,a.createElement)("span",{className:"components-form-toggle "+o+" "+c},(0,a.createElement)("input",{onKeyDown:e=>(e=>{"Enter"===e.key&&(e.preventDefault(),n())})(e),checked:r.value,className:"components-form-toggle__input",onChange:e=>n(),id:r.id,type:"checkbox",disabled:e.disabled}),(0,a.createElement)("span",{className:"components-form-toggle__track"}),(0,a.createElement)("span",{className:"components-form-toggle__thumb"})),(0,a.createElement)("label",{htmlFor:r.id,className:"components-toggle-control__label"},e.label)))))},M=()=>{const[e,t]=(0,a.useState)(""),[l,i]=(0,a.useState)(!1);let o=l||0===e.length;return(0,a.createElement)(a.Fragment,null,(0,a.createElement)(s.TextareaControl,{disabled:l,placeholder:(0,n.__)("Type your question here","really-simple-ssl"),onChange:e=>(e=>{t(e)})(e)}),(0,a.createElement)(s.Button,{disabled:o,variant:"secondary",onClick:t=>(i(!0),r.SA("supportData","refresh").then((t=>{let l=e.replace(/(?:\r\n|\r|\n)/g,"--br--"),a="https://really-simple-ssl.com/support?customername="+encodeURIComponent(t.customer_name)+"&email="+t.email+"&domain="+t.domain+"&scanresults="+encodeURIComponent(t.scan_results)+"&licensekey="+encodeURIComponent(t.license_key)+"&supportrequest="+encodeURIComponent(l)+"&htaccesscontents="+encodeURIComponent(t.htaccess_contents)+"&debuglog="+encodeURIComponent(t.system_status);window.location.assign(a)})))},(0,n.__)("Send","really-simple-ssl")))},P=(0,L.Ue)(((e,t)=>({learningModeData:[],dataLoaded:!1,fetchLearningModeData:async t=>{let l={};l.type=t,l.lm_action="get";let a=await r.Kw("learning_mode_data",l).then((e=>e));"object"==typeof a&&(a=Object.values(a)),Array.isArray(a)||(a=[]),e({learningModeData:a,dataLoaded:!0})},updateStatus:async(l,a,s)=>{let n=t().learningModeData,i={};i.type=s,i.updateItemId=a.id,i.enabled=1==l?0:1,i.lm_action="update";for(const e of n)a.id===e.id&&e.status&&(e.status=i.enabled);e({learningModeData:n}),n=await r.Kw("learning_mode_data",i).then((e=>e)),"object"==typeof n&&(n=Object.values(n)),Array.isArray(n)||(n=[]),e({learningModeData:n,dataLoaded:!0})},deleteData:async(l,a)=>{let s=t().learningModeData,n={};n.type=a,n.updateItemId=l.id,n.lm_action="delete",s.forEach((function(e,t){e.id===l.id&&s.splice(t,1)})),e({learningModeData:s}),s=await r.Kw("learning_mode_data",n).then((e=>e)),"object"==typeof s&&(s=Object.values(s)),Array.isArray(s)||(s=[]),e({learningModeData:s,dataLoaded:!0})}}))),O=e=>{const{updateStatus:t}=P();let l=1==e.item.status?"button button-primary rsssl-status-allowed":"button button-default rsssl-status-revoked",s=1==e.item.status?(0,n.__)("Revoke","really-simple-ssl"):(0,n.__)("Allow","really-simple-ssl");return(0,a.createElement)("button",{onClick:()=>t(e.item.status,e.item,e.field.id),className:l},s)},H=e=>{const{deleteData:t}=P();return(0,a.createElement)("button",{type:"button",className:" rsssl-learning-mode-delete",onClick:()=>t(e.item,e.field.id)},(0,a.createElement)("svg",{"aria-hidden":"true",focusable:"false",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",height:"16"},(0,a.createElement)("path",{fill:"#000000",d:"M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"})))},j=e=>{const{updateField:t,getFieldValue:s,getField:i,setChangedField:r,highLightField:c,saveFields:d}=(0,o.Z)(),{fetchLearningModeData:m,learningModeData:u,dataLoaded:p}=P(),[_,f]=(0,a.useState)(0),[h,y]=(0,a.useState)(0),[g,b]=(0,a.useState)(0),[v,E]=(0,a.useState)(0),[w,k]=(0,a.useState)(!1),[N,C]=(0,a.useState)(0),[D,F]=(0,a.useState)(-1),[x,L]=(0,a.useState)(!1),[T,A]=(0,a.useState)(null),[Z,R]=(0,a.useState)(null);(0,a.useEffect)((()=>{Promise.resolve().then(l.bind(l,44)).then((e=>{let{default:t,createTheme:l}=e;A((()=>t)),R((()=>l("really-simple-plugins",{divider:{default:"transparent"}},"light")))}))}),[]),(0,a.useEffect)((()=>{(async()=>{await m(e.field.id);let t=i(e.field.control_field),l="enforced-by-thirdparty"===t.value,a=l||"enforce"===t.value;L(t),f(l),E("completed"===t.value),k("error"===t.value),C(s(e.field.control_field+"_lm_enabled_once")),y(a),b("learning_mode"===t.value)})()}),[h,g]);const I=(e,l)=>{e.preventDefault();let a=1==l?"enforce":"disabled";y(l),E(0),b(0),r(x.id,a),t(x.id,a),d(!0,!1),m()},M=async l=>{l.preventDefault();let a,s=i(e.field.control_field+"_lm_enabled_once");g&&(C(1),t(s.id,1)),g||v?(b(0),a="disabled"):(b(1),a="learning_mode"),E(0),r(x.id,a),t(x.id,a),r(s.id,s.value),t(s,s.value),await d(!0,!1)};let j=e.field,U=(0,n.__)(" The %s is now in report-only mode and will collect directives. This might take a while. Afterwards you can Exit, Edit and Enforce these Directives.","really-simple-ssl").replace("%s",j.label),V=(0,n.__)("%s has been disabled.","really-simple-ssl").replace("%s",j.label),K=(0,n.__)("%s is enforced.","really-simple-ssl").replace("%s",j.label),B=!N;_&&(V=(0,n.__)("%s is already set outside Really Simple SSL.","really-simple-ssl").replace("%s",j.label));let z="rsssl-field-wrap";e.field.id;let q=[];j.columns.forEach((function(e,t){let l={name:e.name,sortable:e.sortable,width:e.width,selector:t=>t[e.column]};q.push(l)}));let W=u;W=W.filter((e=>e.status<2)),-1!=D&&(W=W.filter((e=>e.status==D)));for(const t of W)t.login_status&&(t.login_statusControl=1==t.login_status?(0,n.__)("success","really-simple-ssl"):(0,n.__)("failed","really-simple-ssl")),t.statusControl=(0,a.createElement)(O,{item:t,field:e.field}),t.deleteControl=(0,a.createElement)(H,{item:t,field:e.field});return T&&Z?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",null,!p||0==W.length&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"rsssl-learningmode-placeholder"},(0,a.createElement)("div",null),(0,a.createElement)("div",null),(0,a.createElement)("div",null),(0,a.createElement)("div",null))),W.length>0&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(T,{columns:q,data:W,dense:!0,pagination:!0,noDataComponent:(0,n.__)("No results","really-simple-ssl"),persistTableHead:!0,theme:Z,customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},conditionalRowStyles:[{when:e=>0==e.status,classNames:["rsssl-datatables-revoked"]}]})),(0,a.createElement)("div",{key:"2",className:"rsssl-learning-mode-footer "},w&&(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-progress-status rsssl-learning-mode-error"},(0,n.__)("Error detected","really-simple-ssl")),(0,n.__)("%s cannot be implemented due to server limitations. Check your notices for the detected issue.","really-simple-ssl").replace("%s",j.label)," ",(0,a.createElement)("a",{className:"rsssl-learning-mode-link",href:"#",onClick:e=>I(e,!1)},(0,n.__)("Disable","really-simple-ssl")))),!w&&(0,a.createElement)(a.Fragment,null,1!=h&&(0,a.createElement)("button",{disabled:B,className:"button button-primary",onClick:e=>I(e,!0)},(0,n.__)("Enforce","really-simple-ssl")),!_&&1==h&&(0,a.createElement)("button",{className:"button",onClick:e=>I(e,!1)},(0,n.__)("Disable","really-simple-ssl")),(0,a.createElement)("label",null,(0,a.createElement)("input",{type:"checkbox",disabled:h,checked:1==g,value:g,onChange:e=>M(e)}),(0,n.__)("Enable Learning Mode to configure automatically","really-simple-ssl")),1==h&&(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-shield-overlay"},(0,a.createElement)(S.Z,{name:"shield",size:"80px"})),(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-progress-status rsssl-learning-mode-enforced"},(0,n.__)("Enforced","really-simple-ssl")),K," ",(0,a.createElement)("a",{className:"rsssl-learning-mode-link",href:"#",onClick:e=>I(e)},(0,n.__)("Disable to configure","really-simple-ssl")))),1==g&&(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-progress-status rsssl-learning-mode"},(0,n.__)("Learning Mode","really-simple-ssl")),U," ",(0,a.createElement)("a",{className:"rsssl-learning-mode-link",href:"#",onClick:e=>M(e)},(0,n.__)("Exit","really-simple-ssl")))),1==v&&(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-progress-status rsssl-learning-mode-completed"},(0,n.__)("Learning Mode","really-simple-ssl")),(0,n.__)("We finished the configuration.","really-simple-ssl")," ",(0,a.createElement)("a",{className:"rsssl-learning-mode-link",href:"#",onClick:e=>M(e)},(0,n.__)("Review the settings and enforce the policy","really-simple-ssl")))),rsssl_settings.pro_plugin_active&&e.disabled&&(0,a.createElement)("div",{className:"rsssl-locked "},(0,a.createElement)("div",{className:"rsssl-locked-overlay"},!_&&(0,a.createElement)("span",{className:"rsssl-progress-status rsssl-disabled"},(0,n.__)("Disabled","really-simple-ssl")),_&&(0,a.createElement)("span",{className:"rsssl-progress-status rsssl-learning-mode-enforced"},(0,n.__)("Enforced","really-simple-ssl")),V))),(0,a.createElement)((()=>(0,a.createElement)(a.Fragment,null,(0,a.createElement)("select",{onChange:e=>F(e.target.value),value:D},(0,a.createElement)("option",{value:"-1"},(0,n.__)("All","really-simple-ssl")),(0,a.createElement)("option",{value:"1"},(0,n.__)("Allowed","really-simple-ssl")),(0,a.createElement)("option",{value:"0"},(0,n.__)("Blocked","really-simple-ssl"))))),null)))):null},U=l(9196),V=l(870),K=e=>{const{riskData:t,dummyRiskData:s,processing:n,dataLoaded:i,fetchVulnerabilities:r,updateRiskData:c}=(0,V.Z)(),{fields:d,fieldAlreadyEnabled:m,getFieldValue:u,setChangedField:p,updateField:_,saveFields:f}=(0,o.Z)(),[h,y]=(0,U.useState)(!1),[g,b]=(0,U.useState)(!1),[v,E]=(0,U.useState)(null),[w,k]=(0,U.useState)(null);(0,U.useEffect)((()=>{Promise.resolve().then(l.bind(l,44)).then((e=>{let{default:t,createTheme:l}=e;E((()=>t)),k((()=>l("really-simple-plugins",{divider:{default:"transparent"}},"light")))}))}),[]),(0,U.useEffect)((()=>{m("enable_vulnerability_scanner")&&(i||r());let e=m("enable_vulnerability_scanner");b(e);let t=1==u("measures_enabled");y(t)}),[d]),(0,U.useEffect)((()=>{let e=1==u("measures_enabled");y(e)}),[]);let N=[];e.field.columns.forEach((function(e,t){let l={name:(a=e).name,sortable:a.sortable,width:a.width,selector:e=>e[a.column],grow:a.grow};var a;N.push(l)}));let S=e.field.options;S=Object.entries(S).map((e=>({label:e[1],value:e[0]})));let C=[...t];C=0===C.length?[...s]:C;let D=!g||!h;for(const e in C){let t={...C[e]};t.riskSelection=(0,a.createElement)("select",{disabled:n||D,value:t.value,onChange:e=>{return l=e.target.value,void c(t.id,l);var l}},S.map(((e,l)=>(0,a.createElement)("option",{key:l,value:e.value,disabled:t.disabledRiskLevels&&t.disabledRiskLevels.includes(e.value)},e.label)))),C[e]=t}let F=D?"rsssl-processing":"";return(0,a.createElement)("div",{className:F},v&&(0,a.createElement)(v,{columns:N,data:Object.values(C),theme:w}))},B=l(44),z=(0,L.Ue)(((e,t)=>({step:0,setStep:t=>e({step:t})}))),q=l(2387),W=e=>{const[t,l]=(0,a.useState)(!0),{setChangedField:s,updateField:n,saveFields:i}=(0,o.Z)(),{getProgressData:r}=(0,q.Z)(),{step:c,setStep:d}=z(),{fetchFirstRun:m,fetchVulnerabilities:u,setIntroCompleted:p}=(0,V.Z)();let _=t?"icon-spin":"";(0,a.useEffect)((()=>{0===c&&1===e.currentStep?f():1===c&&2===e.currentStep?h():2===c&&3===e.currentStep?y():3===c&&4===e.currentStep&&g()}),[c]);const f=async()=>{await m(),b()},h=async()=>{await u(),b()},y=async()=>{await r(),b()},g=async()=>{p(!0),s("vulnerabilities_intro_shown",!0),n("vulnerabilities_intro_shown",!0),await i(!0,!1),b()},b=()=>{setTimeout((function(){l(!1),d(c+1)}),1e3)};return(0,a.createElement)("div",{className:"rsssl-details"},(0,a.createElement)("div",{className:"rsssl-detail-icon "+_},t?(0,a.createElement)(S.Z,{name:"spinner"}):(0,a.createElement)(S.Z,{name:"circle-check",color:"green"})),(0,a.createElement)("div",{className:"rsssl-detail"},(0,a.createElement)("div",{className:"rsssl-detail-title"},e.title)))},Y=()=>{const[e,t]=(0,a.useState)(!1),[l,i]=(0,a.useState)(!0),{step:r}=z();return(0,a.useEffect)((()=>{4===r&&i(!1)}),[r]),e?null:(0,a.createElement)(a.Fragment,null,(0,a.createElement)(s.Modal,{title:(0,n.__)("Introducing vulnerabilities","really-simple-ssl"),className:"rsssl-modal",onRequestClose:()=>{l||t(!0)},shouldCloseOnClickOutside:!0,shouldCloseOnEsc:!0,overlayClassName:"rsssl-modal-overlay"},(0,a.createElement)("div",{className:"rsssl-header-extension"},(0,a.createElement)("div",null,(0,a.createElement)("p",null,(0,n.__)("You have enabled vulnerability detection! Really Simple SSL will check your plugins, themes and WordPress core daily and report if any known vulnerabilities are found.","really-simple-ssl")),(0,a.createElement)("img",{className:"rsssl-intro-logo",src:rsssl_settings.plugin_url+"/assets/img/really-simple-ssl-intro.svg"}))),(0,a.createElement)("div",{className:"rsssl-ssl-intro-container"},(0,a.createElement)(W,{title:(0,n.__)("Preparing vulnerability detection","really-simple-ssl"),name:"first_runner",loading:!0,currentStep:1}),(0,a.createElement)(W,{title:(0,n.__)("Collecting plugin, theme and core data","really-simple-ssl"),name:"second_runner",loading:!0,currentStep:2}),(0,a.createElement)(W,{title:(0,n.__)("Scanning your WordPress configuration","really-simple-ssl"),name:"third_runner",loading:!0,currentStep:3}),(0,a.createElement)(W,{title:(0,n.__)("Reporting enabled","really-simple-ssl"),name:"fourth_runner",loading:!0,currentStep:4})),(0,a.createElement)("div",{className:"rsssl-modal-footer"},(0,a.createElement)(s.Button,{disabled:l,isPrimary:!0,onClick:()=>{t(!0),window.location.hash="dashboard"}},(0,n.__)("Dashboard","really-simple-ssl")),(0,a.createElement)(s.Button,{disabled:l,isSecondary:!0,onClick:()=>{t(!0)}},(0,n.__)("Dismiss","really-simple-ssl")))))},$=e=>{const{getProgressData:t}=(0,q.Z)(),{dataLoaded:l,vulList:s,introCompleted:i,fetchVulnerabilities:r,setDataLoaded:c,fetchFirstRun:d}=(0,V.Z)(),{fields:m,fieldAlreadyEnabled:u,getFieldValue:p}=(0,o.Z)(),[_,f]=(0,U.useState)(!1);let h=[],y=e.field,g=!1;const b={headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}};(0,B.createTheme)("really-simple-plugins",{divider:{default:"transparent"}},"light");y.columns.forEach((function(e,t){let l={name:(a=e).name,sortable:a.sortable,width:a.width,visible:a.visible,selector:e=>e[a.column]};var a;h.push(l)})),(0,U.useEffect)((()=>{u("enable_vulnerability_scanner")&&(1==p("vulnerabilities_intro_shown")||i?l||v():f(!0))}),[m,l]),(0,U.useEffect)((()=>{1!=p("enable_vulnerability_scanner")||u("enable_vulnerability_scanner")||c(!1)}),[m]);const v=async()=>{await d(),await r(),await t()};return m.forEach((function(e,t){"enable_vulnerability_scanner"===e.id&&(g=e.value)})),g?(0,a.createElement)(a.Fragment,null,_&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(Y,null)),(0,a.createElement)(B.default,{columns:h,data:s,dense:!0,pagination:!0,persistTableHead:!0,noDataComponent:(0,n.__)("No vulnerabilities found","really-simple-ssl"),theme:"really-simple-plugins",customStyles:b})):(0,a.createElement)(a.Fragment,null,_&&(0,a.createElement)(a.Fragment,null,(0,a.createElement)(Y,null)),(0,a.createElement)(B.default,{columns:h,data:[["","","","",""],["","","","",""],["","","","",""]],dense:!0,pagination:!0,noDataComponent:(0,n.__)("No results","really-simple-ssl"),persistTableHead:!0,theme:"really-simple-plugins",customStyles:b}),(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-task-status rsssl-open"},(0,n.__)("Disabled","really-simple-ssl")),(0,a.createElement)("span",null,(0,n.__)("Activate vulnerability detection to enable this block.","really-simple-ssl")))))},G=l(7650),Q=(0,L.Ue)(((e,t)=>({roles:[],rolesLoaded:!1,fetchRoles:async t=>{try{const l=await r.Kw("get_roles",{id:t});if(!l)return void console.error("No response received from the server.");const a=l.roles;if("object"!=typeof a)return void console.error("Invalid data received in the server response. Expected an object.");const s=Object.values(a).map(((e,t)=>({value:e,label:e})));e({roles:s,rolesLoaded:!0})}catch(e){console.error("Error:",e)}}}))),J=e=>{let{field:t}=e;const{fetchRoles:l,roles:s,rolesLoaded:i}=Q(),[c,d]=(0,U.useState)([]),{fields:m,updateField:u,setChangedField:p}=(0,o.Z)();let _=!1;(0,U.useEffect)((()=>{(async()=>{await l(t.id)})()}),[]),(0,U.useEffect)((()=>{(async()=>{try{await r.Kw("get_roles",{id:t.id});const e=t.value.map((e=>({value:e,label:e})));d(e)}catch(e){console.error(e)}})()}),[i]);const f=e=>{const l=e.map((e=>e.value));u(t.id,l),p(t.id,l),d(e)},h={multiValue:e=>({...e,borderRadius:"10px",backgroundColor:"two_fa_forced_roles"===t.id?"#F5CD54":"two_fa_optional_roles"===t.id?"#FDF5DC":"default"}),multiValueRemove:(e,t)=>({...e,color:t.isHovered?"initial":e.color,opacity:"0.7",":hover":{backgroundColor:"initial",color:"initial",opacity:"1"}})};return m.forEach((function(e,t){"two_fa_enabled"===e.id&&(_=e.value)})),_?(0,a.createElement)("div",{style:{marginTop:"5px"}},(0,a.createElement)(G.ZP,{isMulti:!0,options:s,onChange:f,value:c,menuPosition:"fixed",styles:h})):(0,a.createElement)("div",{style:{marginTop:"5px"}},(0,a.createElement)(G.ZP,{isMulti:!0,options:s,onChange:f,value:c,menuPosition:"fixed",styles:h}),(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-task-status rsssl-open"},(0,n.__)("Disabled","really-simple-ssl")),(0,a.createElement)("span",null,(0,n.__)("Activate login protection to enable this block.","really-simple-ssl")))))},X=e=>{const{addHelpNotice:t}=(0,o.Z)();let l=!!e.field.disabled;return(0,a.createElement)(a.Fragment,null,e.field.url&&(0,a.createElement)(_.Z,{className:"button button-default",disabled:l,text:e.field.button_text,url:e.field.url}),e.field.action&&(0,a.createElement)("button",{onClick:()=>{return l=e.field.action,void r.Kw(l,{}).then((l=>{let a=l.success?"success":"warning",s=(0,n.__)("Test notification by email","really-simple-ssl"),i=l.message;t(e.field.id,a,i,s,!1)}));var l},className:"button button-default",disabled:l},e.field.button_text))},ee=l(7462),te=l(1898),le=l(6989),ae=l.n(le),se=e=>{let{field:t}=e;const[s,i]=(0,U.useState)([]),[r,c]=(0,U.useState)(""),{updateField:d,setChangedField:m}=(0,o.Z)(),[u,p]=(0,U.useState)(null),[_,f]=(0,U.useState)(null),[h,y]=(0,U.useState)(null);return(0,U.useEffect)((()=>{l.e(964).then(l.bind(l,9964)).then((e=>{let{default:t}=e;y((()=>t))})),l.e(812).then(l.bind(l,2812)).then((e=>{let{createTheme:t,ThemeProvider:l}=e;p((()=>l)),f((()=>t({typography:{fontSize:12,fontFamily:"inherit"},overrides:{MuiInputBase:{root:{fontSize:"12px",fontFamily:"inherit",height:"40px"}},MuiList:{root:{fontSize:"8px"}},MuiAutocomplete:{inputRoot:{"& .MuiAutocomplete-input":{padding:"0 !important",border:0},flexWrap:"inherit"},popper:{fontSize:"12px"},paper:{fontSize:"12px"},option:{fontSize:"12px"},root:{padding:0}}}})))}))}),[]),(0,U.useEffect)((()=>{ae()({path:"/wp/v2/pages?per_page=100"}).then((e=>{const t=e.map((e=>({title:e.title.rendered,id:e.id})));i([{title:"404 (default)",id:"404_default"},...t])}))}),[]),(0,U.useEffect)((()=>{"404_default"!==t.value?ae()({path:`wp/v2/pages/${t.value}`}).then((e=>{e.title?c({title:e.title.rendered,id:t.value}):c({title:"404 (default)",id:"404_default"})})):c({title:"404 (default)",id:"404_default"})}),[t.value]),h&&u&&_?(0,a.createElement)("div",null,(0,a.createElement)("label",{htmlFor:"rsssl-filter-post-input"},(0,n.__)("Redirect to this post when someone tries to access /wp-admin or /wp-login.php. The default is a 404 page.","really-simple-ssl")),(0,a.createElement)(u,{theme:_},(0,a.createElement)(h,{options:s,getOptionLabel:e=>e.title?e.title:"",renderInput:e=>(0,a.createElement)(te.Z,(0,ee.Z)({},e,{variant:"outlined",placeholder:(0,n.__)("Search for a post.","really-simple-ssl")})),getOptionSelected:(e,t)=>e.id===t.id,onChange:(e,l)=>{let a=l&&l.id?l.id:"404_default";d(t.id,a),m(t.id,a)},value:r}))):null},ne=e=>{const{fetchVulnerabilities:t,riskLevels:l}=(0,V.Z)(),{field:s}=e,[i,c]=(0,U.useState)(!0),[d,m]=(0,U.useState)(!0),[u,p]=(0,U.useState)(!1),[_,f]=(0,U.useState)(!1),{addHelpNotice:h,fields:y,getFieldValue:g,updateField:b,setChangedField:v,fieldAlreadyEnabled:E,fetchFieldsData:w,updateFieldAttribute:k}=(0,o.Z)();(0,U.useEffect)((()=>{let e=1==g("send_notifications_email"),t=E("enable_vulnerability_scanner");m(e),c(!(e&&t)),m(e),f(t),p(1==g("enable_vulnerability_scanner"))}),[y]),(0,U.useEffect)((()=>{let e=g("vulnerability_notification_dashboard");e=l.hasOwnProperty(e)?l[e]:0;let t=e>0?e-1:e,a=Array.from(Array(t).keys()).map((e=>e));if(a=a.map((e=>Object.keys(l).find((t=>l[t]===e)))),a.length>0){k("vulnerability_notification_sitewide","disabled",a);let t=g("vulnerability_notification_sitewide");if(t=l.hasOwnProperty(t)?l[t]:0,t<e){let t=Object.keys(l).find((t=>l[t]===e));b("vulnerability_notification_sitewide",t),v("vulnerability_notification_sitewide",t)}}else k("vulnerability_notification_sitewide","disabled",!1)}),[g("vulnerability_notification_dashboard")]);let N={...s};return d?u&&!_&&(N.tooltip=(0,n.__)("The notification test only works if you save the setting first.","really-simple-ssl"),N.warning=!0):(N.tooltip=(0,n.__)("You have not enabled the email notifications in the general settings.","really-simple-ssl"),N.warning=!0),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("label",null,e.labelWrap(N)),(0,a.createElement)("button",{onClick:()=>(async()=>{c(!0),r.Kw("vulnerabilities_test_notification").then((()=>{c(!1),w("vulnerabilities"),t(),h(s.id,"success",(0,n.__)("All notifications are triggered successfully, please check your email to double-check if you can receive emails.","really-simple-ssl"),(0,n.__)("Test notifications","really-simple-ssl"),!1)}))})(),disabled:i,className:"button button-default"},s.button_text))},ie=l(5902),re=l(2902),oe=(0,L.Ue)(((e,t)=>({twoFAMethods:{},setTwoFAMethods:t=>e((e=>({...e,twoFAMethods:t}))),processing:!1,dataLoaded:!1,pagination:{},dataActions:{},DynamicDataTable:[],fetchDynamicData:async l=>{try{const a=await r.Kw(l,t().dataActions);if(a)return e((e=>({...e,DynamicDataTable:a.data,dataLoaded:!0,processing:!1,pagination:a.pagination}))),a}catch(e){console.log(e)}},handleTableSearch:async(t,l)=>{e((0,re.Uy)((e=>{e.dataActions={...e.dataActions,search:t,searchColumns:l}})))},handleTablePageChange:async(t,l)=>{e((0,re.Uy)((e=>{e.dataActions={...e.dataActions,page:t,pageSize:l}})))},handleTableRowsChange:async(t,l)=>{e((0,re.Uy)((e=>{e.dataActions={...e.dataActions,currentRowsPerPage:t,currentPage:l}})))},handleTableSort:async(t,l)=>{e((0,re.Uy)((e=>{e.dataActions={...e.dataActions,sortColumn:t,sortDirection:l}})))},updateUserMeta:async(t,l)=>{e((0,re.Uy)((e=>{const a=e.DynamicDataTable.findIndex((e=>e.id===t));-1!==a&&(e.DynamicDataTable[a].rsssl_two_fa_method=l)})));let a={};a.userId=t,a.method=l,await r.Kw("store_two_fa_usermeta",a)}}))),ce=e=>{const{twoFAMethods:t,setTwoFAMethods:l,DynamicDataTable:s,dataLoaded:i,pagination:r,dataActions:c,handleTableRowsChange:d,fetchDynamicData:m,handleTableSort:u,handleTablePageChange:p,handleTableSearch:_,updateUserMeta:f}=oe();let h=e.field;const[y,g]=(0,U.useState)(!1),{fields:b,getFieldValue:v,saveFields:E}=(0,o.Z)(),w=(0,U.useRef)();(0,U.useEffect)((()=>{w.current=v("two_fa_enabled"),E(!0,!1)}),[v("two_fa_enabled")]),(0,U.useEffect)((()=>{const e=v("two_fa_enabled");g(e)}),[b]),(0,U.useEffect)((()=>{i&&y===v("two_fa_enabled")||m(h.action).then((e=>{if(e.data&&Array.isArray(e.data)){const t=e.data.reduce(((e,t)=>({...e,[t.id]:t.rsssl_two_fa_method})),{});l(t)}else console.error("Unexpected response:",e)})).catch((e=>{console.error(e)}))}),[i,h.action,m,v("two_fa_enabled")]),(0,U.useEffect)((()=>{c&&m(h.action)}),[c]);let k=[];h.columns.forEach((function(e,s){var i;let r={...e,key:e.column};r=function(e){let s={name:e.name,column:e.column,sortable:e.sortable,searchable:e.searchable,width:e.width,visible:e.visible,selector:t=>t[e.column]};return"Action"===s.name&&(s.cell=e=>(0,a.createElement)("select",{value:t[e.id],onChange:a=>{return s=e.id,n=a.target.value,l({...t,[s]:n}),void ae()({path:`/wp/v2/users/${s}`,method:"POST",data:{meta:{rsssl_two_fa_method:n}}}).then((e=>{f(s,n)})).catch((e=>{console.error("Error updating user meta:",e)}));var s,n}},(0,a.createElement)("option",{value:"open"},(0,n.__)("Choose","really-simple-ssl")),(0,a.createElement)("option",{value:"disabled"},(0,n.__)("Disabled","really-simple-ssl")),(0,a.createElement)("option",{value:"email"},"Email"))),s}(r),r.visible=null===(i=r.visible)||void 0===i||i,k.push(r)}));let N=k.filter((e=>e.searchable)).map((e=>e.column));return(0,B.createTheme)("really-simple-plugins",{divider:{default:"transparent"}},"light"),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"rsssl-search-bar"},(0,a.createElement)("div",{className:"rsssl-search-bar__inner"},(0,a.createElement)("div",{className:"rsssl-search-bar__icon"}),(0,a.createElement)("input",{type:"text",className:"rsssl-search-bar__input",placeholder:(0,n.__)("Search","really-simple-ssl"),onChange:e=>_(e.target.value,N)}))),i?(0,a.createElement)(B.default,{columns:k,data:s,dense:!0,pagination:!0,paginationServer:!0,onChangeRowsPerPage:d,onChangePage:p,sortServer:!0,onSort:u,paginationRowsPerPageOptions:[10,25,50,100],noDataComponent:(0,n.__)("No results","really-simple-ssl"),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}}}):(0,a.createElement)("div",{className:"rsssl-spinner",style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"100px"}},(0,a.createElement)("div",{className:"rsssl-spinner__inner"},(0,a.createElement)("div",{className:"rsssl-spinner__icon",style:{border:"8px solid white",borderTop:"8px solid #f4bf3e",borderRadius:"50%",width:"120px",height:"120px",animation:"spin 2s linear infinite"}}),(0,a.createElement)("div",{className:"rsssl-spinner__text",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},(0,n.__)("Loading data, please stand by...","really-simple-ssl")))),!y&&(0,a.createElement)("div",{className:"rsssl-locked"},(0,a.createElement)("div",{className:"rsssl-locked-overlay"},(0,a.createElement)("span",{className:"rsssl-task-status rsssl-open"},(0,n.__)("Disabled","really-simple-ssl")),(0,a.createElement)("span",null,(0,n.__)("Activate login protection to enable this block.","really-simple-ssl")))))},de=e=>{let t=React.createRef();const{updateField:l,setChangedField:i,highLightField:r}=(0,o.Z)(),[c,f]=(0,a.useState)(null);(0,a.useEffect)((()=>{f((0,ie.Z)("anchor")),h(),r===e.field.id&&t.current&&t.current.scrollIntoView({behavior:"smooth",block:"start"})}),[]),(0,a.useEffect)((()=>{h()}),[c]),window.addEventListener("hashchange",(e=>{f((0,ie.Z)("anchor"))}));const h=()=>{c&&c===e.field.id&&t.current.scrollIntoView({behavior:"smooth",block:"start"})},y=t=>{let a=e.field;if(a.pattern){const e=new RegExp(a.pattern,"g"),l=t.match(e);t=l?l.join(""):""}l(a.id,t);let s=!1;if(a.configure_on_activation){a.configure_on_activation.hasOwnProperty("condition")&&e.field.value==a.configure_on_activation.condition&&(s=!0);let t=a.configure_on_activation[0];for(let e in t)s&&t.hasOwnProperty(e)&&l(e,t[e])}i(a.id,t)},g=e=>{let t=e.warning?"red":"black";return(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"cmplz-label-text"},e.label),e.tooltip&&(0,a.createElement)(S.Z,{name:"info-open",tooltip:e.tooltip,color:t}))};let b=e.field,v=b.value,E=b.disabled,w="rsssl-field-wrap";r===e.field.id&&(w="rsssl-field-wrap rsssl-highlight");let N=[];if(b.options)for(var C in b.options)if(b.options.hasOwnProperty(C)){let e={};e.label=b.options[C],e.value=C,N.push(e)}if(!rsssl_settings.networkwide_active&&b.networkwide_required&&(E=!0,b.comment=(0,a.createElement)(a.Fragment,null,(0,n.__)("This feature is only available networkwide.","really-simple-ssl"),(0,a.createElement)(_.Z,{target:"_blank",text:(0,n.__)("Network settings","really-simple-ssl"),url:rsssl_settings.network_link}))),b.conditionallyDisabled&&(E=!0),!b.visible)return(0,a.createElement)(a.Fragment,null);if("checkbox"===b.type)return(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(I,{label:g(b),field:b,disabled:E,onChangeHandler:e=>y(e)}),b.comment&&(0,a.createElement)("div",{className:"rsssl-comment",dangerouslySetInnerHTML:{__html:b.comment}}));if("hidden"===b.type)return(0,a.createElement)("input",{type:"hidden",value:b.value});if("radio"===b.type)return(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(s.RadioControl,{label:g(b),onChange:e=>y(e),selected:v,options:N}));if("email"===b.type){const l=e.fields.find((e=>"send_verification_email"===e.id)),n=l&&l.disabled;return(0,a.createElement)("div",{className:w,ref:t,style:{position:"relative"}},(0,a.createElement)(s.TextControl,{required:b.required,placeholder:b.placeholder,disabled:E,help:b.comment,label:g(b),onChange:e=>y(e),value:v}),(0,a.createElement)("div",{className:"rsssl-email-verified"},n?(0,a.createElement)(S.Z,{name:"circle-check",color:"green"}):(0,a.createElement)(S.Z,{name:"circle-times",color:"red"})))}if("text"===b.type)return(0,a.createElement)("div",{className:w,ref:t,style:{position:"relative"}},(0,a.createElement)(s.TextControl,{required:b.required,placeholder:b.placeholder,disabled:E,help:b.comment,label:g(b),onChange:e=>y(e),value:v}));if("button"===b.type)return(0,a.createElement)("div",{className:"rsssl-field-button "+w,ref:t},(0,a.createElement)("label",null,b.label),(0,a.createElement)(X,{field:b}));if("password"===b.type)return(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(m,{index:e.index,field:b}));if("textarea"===b.type)return(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(s.TextareaControl,{label:b.label,help:b.comment,value:v,onChange:e=>y(e),disabled:b.disabled}));if("license"===b.type){let l=e.field,s=l.value;return(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(d,{index:e.index,field:l,fieldValue:s}))}return"number"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(s.__experimentalNumberControl,{onChange:e=>y(e),help:b.comment,label:b.label,value:v})):"email"===b.type?(0,a.createElement)("div",{className:(void 0).highLightClass,ref:(void 0).scrollAnchor},(0,a.createElement)(s.TextControl,{help:b.comment,label:b.label,onChange:e=>(void 0).onChangeHandler(e),value:v})):"host"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(p,{index:e.index,field:e.field})):"select"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(u,{disabled:E,label:g(b),onChangeHandler:e=>y(e),value:v,options:N,field:b})):"support"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(M,null)):"postdropdown"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(se,{field:e.field})):"permissionspolicy"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(R,{disabled:E,field:e.field,options:N})):"learningmode"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(j,{disabled:E,field:e.field})):"riskcomponent"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(K,{field:e.field})):"mixedcontentscan"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(Z,{field:e.field})):"vulnerabilitiestable"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)($,{field:e.field})):"two_fa_dropdown"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)("label",{htmlFor:"rsssl-two-fa-dropdown-{field.id}"},g(b)),(0,a.createElement)(J,{field:e.field})):"dynamic-datatable"===b.type?(0,a.createElement)("div",{className:w,ref:t},(0,a.createElement)(ce,{field:e.field,action:e.field.action})):"notificationtester"===b.type?(0,a.createElement)("div",{className:"rsssl-field-button "+w,ref:t},(0,a.createElement)(ne,{field:e.field,labelWrap:g})):"letsencrypt"===b.type?(0,a.createElement)(D,{field:b}):"activate"===b.type?(0,a.createElement)(k,{field:b}):"not found field type "+b.type}},870:function(e,t,l){var a=l(9307),s=l(270),n=l(8473),i=l(5736),r=l(2902);l(9196);const o=(0,s.Ue)(((e,t)=>({dummyRiskData:[{id:"force_update",name:"Force Update",value:"l",description:(0,i.__)("Force update the plugin or theme","really-simple-ssl")},{id:"quarantine",name:"Quarantine",value:"m",description:(0,i.__)("Isolates the plugin or theme if no update can be performed","really-simple-ssl")}],riskData:[],riskLevels:{l:1,m:2,h:3,c:4},vulnerabilities:[],processing:!1,dataLoaded:!1,updates:0,HighestRisk:!1,lastChecked:"",vulEnabled:!1,riskNaming:{},introCompleted:!1,vulList:[],setDataLoaded:t=>e({dataLoaded:t}),updateRiskData:async(l,a)=>{e({processing:!0}),e((0,r.Uy)((e=>{let s=e.riskData.findIndex((e=>e.id===l));e.riskData[s].value=a,e.riskData=t().enforceCascadingRiskLevels(e.riskData)})));try{await n.Kw("vulnerabilities_measures_set",{riskData:t().riskData}),e({dataLoaded:!0,processing:!1})}catch(e){console.log(e)}},setIntroCompleted:t=>{e({introCompleted:t})},enforceCascadingRiskLevels:e=>{if(0===e.length)return e;let l=e.filter((e=>"force_update"===e.id))[0].value,a=e.filter((e=>"quarantine"===e.id))[0].value;l=t().riskLevels.hasOwnProperty(l)?t().riskLevels[l]:5,a=t().riskLevels.hasOwnProperty(a)?t().riskLevels[a]:5;let s=e.findIndex((e=>"quarantine"===e.id));a<l&&(e[s].value=Object.keys(t().riskLevels).find((e=>t().riskLevels[e]===l))),5===l&&(e[s].value="*");let n=l>0?l:0,i=Array.from(Array(n).keys()).map((e=>e));return i=i.map((e=>Object.keys(t().riskLevels).find((l=>t().riskLevels[l]===e)))),e[s].disabledRiskLevels=i,e},fetchFirstRun:async()=>{await n.Kw("vulnerabilities_scan_files")},fetchVulnerabilities:async()=>{let l={};try{const s=await n.Kw("hardening_data",l);let o=[],c=0;s.data.vulList&&(c=s.data.vulnerabilities,o=s.data.vulList,"object"==typeof o&&(o=Object.values(o)),o.forEach((function(e,t){let l=e.update_available?rsssl_settings.plugins_url+"?plugin_status=upgrade":"#settings/vulnerabilities";e.vulnerability_action=(0,a.createElement)("div",{className:"rsssl-vulnerability-action"},(0,a.createElement)("a",{className:"button",href:"https://really-simple-ssl.com/vulnerabilities/"+e.rss_identifier,target:"_blank"},(0,i.__)("Details","really-simple-ssl")),(0,a.createElement)("a",{disabled:!e.update_available,href:l,className:"button button-primary"},(0,i.__)("Update","really-simple-ssl")))})));let d=s.data.riskData;Array.isArray(d)||(d=[]),d=t().enforceCascadingRiskLevels(d),e((0,r.Uy)((e=>{e.vulnerabilities=c,e.vulList=o,e.updates=s.data.updates,e.dataLoaded=!0,e.riskNaming=s.data.riskNaming,e.lastChecked=s.data.lastChecked,e.vulEnabled=s.data.vulEnabled,e.riskData=d})))}catch(e){console.error(e)}},vulnerabilityCount:()=>{let e=t().vulList,l=[];return Object.keys(e).forEach((function(t){l.push(e[t])})),["c","h","m","l"].map((function(e){return{level:e,count:l.filter((function(t){return t.risk_level===e})).length}}))},vulnerabilityScore:()=>{let e=0,l=t().vulList;return Object.keys(l).forEach((function(t){"c"===l[t].risk_level?e=5:e<1&&(e=1)})),e},hardeningScore:()=>{let e=0,l=t().vulnerabilities;for(let t=0;t<l.length;t++)e+=l[t].hardening_score;return e},activateVulnerabilityScanner:async()=>{try{(await n.Kw("rsssl_scan_files")).request_success&&(async()=>{await t().fetchVulnerabilities()})()}catch(e){console.error(e)}}})));t.Z=o}}]);